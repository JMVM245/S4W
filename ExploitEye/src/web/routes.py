from flask import Blueprint, render_template, request, jsonify
from services.scanner import Scanner
from services.reporter import Reporter

main_bp = Blueprint('main', __name__)

@main_bp.route('/')
def index():
    return render_template('index.html')

@main_bp.route('/scan', methods=['POST'])
def scan():
    target = request.json.get('target')
    if not target:
        return jsonify({'error': 'Target is required'}), 400
    
    scanner = Scanner()
    results = scanner.scan(target)
    
    return jsonify(results)

@main_bp.route('/report/<scan_id>')
def get_report(scan_id):
    reporter = Reporter()
    report = reporter.get_report(scan_id)
    
    if not report:
        return jsonify({'error': 'Report not found'}), 404
    
    return jsonify(report)

@main_bp.route('/dashboard')
def dashboard():
    return render_template('dashboard.html') 